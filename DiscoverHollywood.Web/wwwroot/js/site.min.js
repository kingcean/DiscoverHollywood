var DiscoverHollywood;(function(n){function r(n){return n?encodeURIComponent(n.toString()):""}function f(n,t,i,u){return $.getJSON("/api/movies/?q="+r(n)+"&year="+r(t)+"&genres="+r(i)+"&page="+encodeURIComponent(u!=null?u.toString():""))}function e(n){return $.getJSON("/api/movies/"+n)}function o(n){return $.getJSON("/api/movies/"+n+"/ratings")}function i(n){var t;if(n==null)return null;try{if(typeof n=="string")return(t=location.search.match(new RegExp("[?&]"+n+"=([^&]+)","i")),t==null||t.length<1)?"":t[1];if(typeof n=="number")return(t=location.search.match(new RegExp("[?&][^?&]+=[^?&]+","g")),t==null)?"":t[n].substring(1)}catch(i){}return null}function t(n){var r=i(n),t;try{return t=parseInt(r,10),t!=null&&!isNaN(t)?t:undefined}catch(u){return undefined}}function s(){var n=new u,f=function(){n.page(t("page")||0);n.q(i("q"));n.year(t("year"));n.genres(i("genres"));n.updateList();var r=t("id");n.show(r)},r;f();r=document.getElementById("page_container");ko.applyBindings(n,r);r.style.display="";window.addEventListener("popstate",function(){f()})}var u=function(){function n(){this.detail=ko.observable();this.rating=ko.observable();this.years=ko.observableArray();this.list=ko.observableArray();this.page=ko.observable(0);this.year=ko.observable();this.genres=ko.observable();this.q=ko.observable();this.genresList=["","Action","Adventure","Animation","Children's","Comedy","Crime","Documentary","Drama","Fantasy","Film-Noir","Horror","Musical","Mystery","Romance","Sci-Fi","Thriller","War","Western"];for(var n=2016;n>1995;n--)this.years.push(n)}return n.prototype.home=function(){this.detail(null);this.rating(null)},n.prototype.getList=function(){return f(this.q(),this.year(),this.genres(),this.page())},n.prototype.updateList=function(){var n=this;this.getList().then(function(t){n.list(t)})},n.prototype.getMore=function(){var n=this;this.page((this.page()||0)+1);this.getList().then(function(t){(i=n.list).push.apply(i,t);var i})},n.prototype.show=function(n){var r=this,i;if(n==null){this.detail(null);this.rating(null);return}i=t("id");i!=n&&history.pushState(i,null,"?id="+n);e(n).then(function(n){r.detail(n)});o(n).then(function(n){r.rating(n)})},n.prototype.paddingNum=function(n,t){for(var i=n.toString(),r=i.length;r<t;r++)i="0"+i;return i},n}();n.PageModel=u;n.list=f;n.get=e;n.rating=o;n.getQuery=i;n.getQueryAsInt=t;s()})(DiscoverHollywood||(DiscoverHollywood={}));